<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Undiscovered Colors</title>
  <meta name="description" content="Undiscovered Colors - A memoir to a brief excursion in Argentina.">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <link rel="author" href="http://effulgence.io" />

  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/main.css">
  <script src="js/vendor/modernizr-2.7.1.min.js"></script>
</head>

<body class="loading">
  <!--[if lt IE 7]> <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p> <![endif]-->

  <main>
    <!-- <canvas id="canvas"></canvas> -->

    <div id="header">
      <h1>Undiscovered Colors</h1>
      <p>A memoir of a brief excursion in Argentina.</p>
    </div>

    <section id="slide-2">
      <div class="bcg" data-0="background-color:rgb(1,27,59);" data-top="background-color:(0,0,0);" data-anchor-target="#slide-2">
        <div class="hsContainer">
          <div class="hsContent">
            <h2 data-center="opacity: 1" data--200-bottom="opacity: 0" data-206-top="opacity: 1" data-106-top="opacity: 0" data-anchor-target="#slide-2 h2">
              On April 27th, 2016
            </h2>

            <p data-center="opacity: 1" data--200-bottom="opacity: 0" data-206-top="opacity: 1" data-106-top="opacity: 0" data-anchor-target="#slide-2 h2">
              Here we are changing the background color from blue to black. Text is fading in at 206 pixels from the bottom and fading out 106 pixels from the top.
            </p>
          </div>
        </div>
      </div>
    </section>

    <section id="slide-1" class="homeSlide">
      <div class="bcg" data-center="background-position: 50% 0px;" data-top-bottom="background-position: 50% -100px;" data-anchor-target="#slide-1">
        <div class="hsContainer">
          <div class="hsContent" data-center="opacity: 1" data-106-top="opacity: 0" data-anchor-target="#slide-1 h2">
            <h2>Rosario, Argentina</h2>
            <p>This slide moves background image at a slower speed then the page scroll. Text is fading out to opacity 0 at 106 pixels from the top.</p>
          </div>
        </div>
      </div>
    </section>

    <section id="slide-4" class="homeSlide homeSlideTall">
      <div class="bcg" data-center="background-position: 50% 0px;" data-bottom-top="background-position: 50% 0px;" data-top-bottom="background-position: 50% -100px;" data-anchor-target="#slide-4">
        <div class="curtainContainer">

          <div class="curtain" data-bottom-top="opacity: 0" data-106-top="height: 1%; opacity: 0; top: -10%;" data-center="height: 100%; opacity: 0.5; top: 0%;" data-anchor-target="#slide-4"></div>
          <div class="copy" data-bottom-top="opacity: 0" data--100-bottom="opacity: 0" data--280-bottom="opacity: 1;" data-280-top="opacity: 1;" data-106-top="opacity: 0;" data-anchor-target="#slide-4 .copy">
            <h2>Ushuaia, Tierra del Fuego, Argentina</h2>
          </div>

        </div>
      </div>
    </section>

    <!-- <section id="slide-5" class="homeSlide homeSlideTall2">
      <div class="bcg">
        &nbsp;
      </div>
      <div class="bcg bcg2" data-bottom-top="opacity: 0;" data--33p-top="opacity: 0;" data--66p-top="opacity: 1;" data-anchor-target="#slide-5">
        <div class="hsContainer">
          <div class="hsContent" data-bottom-top="opacity: 0;" data-center="opacity: 1" data-anchor-target="#slide-5">
            <h2>El Calafate, Santa Fe, Argentina</h2>
            <p>Showcase your beautiful images before blurring the scene and fading in your headline.</p>
          </div>
        </div>
      </div>
      <div class="bcg bcg3" data-300-bottom="opacity: 0;" data-100-bottom="opacity: 1;" data-anchor-target="#slide-5">
        <div class="hsContainer">
          <div class="hsContent" data-100-bottom="opacity: 0;" data-bottom="opacity: 1;" data-anchor-target="#slide-5">
            <h2>The End</h2>
            <p>Not enough parallax goodness? Let me know in the comments or hit me up at <a href="https://www.twitter.com/ihatetomatoes" target="_blank">@ihatetomatoes</a>.</p>
          </div>
        </div>
      </div>
    </section> -->

  </main>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>
    window.jQuery || document.write('<script src="js/vendor/jquery-1.9.1.min.js"><\/script>')
  </script>
  <script src="js/imagesloaded.js"></script>
  <script src="js/skrollr.js"></script>
  <script src="js/main.js"></script>
  <script src="js/pixi.min.js"></script>
  <script>

    'use strict';
    // ************************************************************************************
    // * Setup Renderer

    var scale = 1;
    var size = [window.innerWidth, window.innerHeight];
    var ratio = size[0] / size[1];
    var ratio = 1.893491124260355;
    // alert(ratio);

    var stage = new PIXI.Container();
    var renderer = PIXI.autoDetectRenderer(size[0], size[1], {
      antialias: false,
      transparent: true,
      resolution: 1
    });

    var interaction = new PIXI.interaction.InteractionManager(renderer);

    prependChild(document.body, renderer.view);
    renderer.render(stage);

    renderer.view.style.display = "block";
    // renderer.view.style.position = "absolute";
    renderer.autoResize = true;
    renderer.resize(1280, 676);

    function resize() {
      var w, h;
      if (window.innerWidth / window.innerHeight >= ratio) {
        w = window.innerHeight * ratio;
        h = window.innerHeight;
        console.log("Greater than ratio - ", w, h, ratio);
      } else {
        w = window.innerWidth;
        h = window.innerWidth / ratio;
        console.log("Less than ratio - ", w, h, ratio);
      }
      renderer.view.style.width = w + 'px';
      renderer.view.style.height = h + 'px';
    }

    window.onresize = function(event) {
      resize();
    };

    // ************************************************************************************
    // * Setup

    var cielo, montanas, persona;
    var mouse = { x: 0, y: 0 }

    PIXI.loader.add(["img/_bg.jpg", "img/_mg.png", "img/_fg.png"]).load(setup);

    function setup() {
      resize();
      cielo = new PIXI.Sprite(PIXI.loader.resources["img/_bg.jpg"].texture);
      cielo.scale.set(1.15, 1.15);

      montanas = new PIXI.Sprite(PIXI.loader.resources["img/_mg.png"].texture);
      montanas.scale.set(1.15, 1.15);

      persona = new PIXI.Sprite(PIXI.loader.resources["img/_fg.png"].texture);
      persona.scale.set(1.15, 1.15);

      stage.addChild(cielo);
      stage.addChild(montanas);
      stage.addChild(persona);

      renderer.render(stage);
      draw();
    }

    // ************************************************************************************
    // * Draw

    function draw() {
      requestAnimationFrame(draw);
      updateMousePosition();
      parallax();
      renderer.render(stage);
    }

    // ************************************************************************************

    function parallax() {
      mouse.x += mouse.x / scale;
      mouse.y += mouse.y / scale;
      var rx = -((renderer.width / 2) - Math.max(15, Math.min(mouse.x, renderer.width - 15))) / 7;
      var ry = -((renderer.height / 2) - Math.max(0, Math.min(mouse.y, renderer.height - 5))) / 4.75;

      // Parallax
      cielo.x = -100 + (rx / 2);
      cielo.y = -100 + (ry / 2);

      // console.log(cielo.x);

      montanas.x = -100 - (rx / 2);
      montanas.y = -100 - (ry / 2);

      persona.x = -100 + (rx / 3);
      persona.y = -100 + (ry / 3);
    }

    function updateMousePosition() {
      mouse.x = interaction.mouse.global.x;
      mouse.y = interaction.mouse.global.y;
    }

    function prependChild(parent, newFirstChild) {
      parent.insertBefore(newFirstChild, parent.firstChild)
    }

  </script>

</body>
</html>
